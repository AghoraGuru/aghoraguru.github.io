<!DOCTYPE html>
<script
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"
  type="text/javascript">
</script>

<html class="no-js">
  <head>
	<meta charset="utf-8">
	<title>PyCaret ğŸš€ | Kalyana Sundaram</title>
	<meta name="description"
		content="The Lazy Person's Guide to Machine Learning ğŸš€ ">
	<meta name="viewport" content="width=device-width, initial-scale=1">

	<!-- CSS -->
	<link rel="stylesheet" href="/assets/css/main.css">

	<!--Favicon-->
	<link rel="shortcut icon" href="/assets/favicon.ico" type="image/x-icon">

	<!-- Canonical -->
	<link rel="canonical" href="/2023/04/11/PyCaret-The-Lazy-Person's-Guide-to-Machine-Learning.html">

	<!-- RSS -->
	<link rel="alternate" type="application/atom+xml" title="Kalyana Sundaram"
		href="/feed.xml" />

	<!-- Font Awesome -->
	<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.2/css/all.css"
		integrity="sha384-oS3vJWv+0UjzBfQzYUhtDYW+Pj2yciDJxpsK1OYPAYjqT085Qq/1cq5FLXAZQ7Ay" crossorigin="anonymous">

	<!-- Google Fonts -->
	
	<link href="//fonts.googleapis.com/css?family=Source+Sans+Pro:400,700,700italic,400italic" rel="stylesheet"
		type="text/css">
	

	<!-- KaTeX -->
	
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/katex.min.css"
		integrity="sha384-yFRtMMDnQtDRO8rLpMIKrtPCD5jdktao2TV19YiZYWMDkUR5GQZR/NOVTdquEx1j" crossorigin="anonymous">

	<script src="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/katex.min.js"
		integrity="sha384-9Nhn55MVVN0/4OFx7EE5kpFBPsEMZxKTCnA+4fqDmg12eCTqGi6+BB2LjY8brQxJ"
		crossorigin="anonymous"></script>
	

	<!-- Google Analytics -->
	
	<!-- Google tag (gtag.js) -->
	<script async src="https://www.googletagmanager.com/gtag/js?id=G-9DPN6XP8MY"></script>
	<script>
	  window.dataLayer = window.dataLayer || [];
	  function gtag(){dataLayer.push(arguments);}
	  gtag('js', new Date());
	
	  gtag('config', 'G-9DPN6XP8MY');
	</script>
	
</head>
  <body>
    <header class="site-header">
	<div class="branding">
		
		<a href="/">
			<img class="avatar" src="/assets/img/avatar.png" alt=""/>
		</a>
		
		<h1 class="site-title">
			<a href="/">Kalyana Sundaram</a>
		</h1>
	</div>
	<nav class="site-nav">
		<ul>
			
			
			
			
			
			<li>
				<a class="page-link" href="/about/">
					About
				</a>
			</li>
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			<!-- Social icons from Font Awesome, if enabled  -->
			


<li>
	<a href="mailto:omenlunatic@gmail.com" title="Email">
		<i class="fas fa-fw fa-envelope"></i>
	</a>
</li>













<li>
	<a href="https://github.com/aghoraguru" title="Follow on GitHub">
		<i class="fab fa-fw fa-github"></i>
	</a>
</li>





<li>
	<a href="http://instagram.com/kalyan.aghora.shivam" title="Follow on Instagram">
		<i class="fab fa-fw fa-instagram"></i>
	</a>
</li>



<li>
	<a href="http://linkedin.com/in/aghoraguru" title="Follow on LinkedIn">
		<i class="fab fa-fw fa-linkedin"></i>
	</a>
</li>

















<li>
	<a href="https://twitter.com/aghoraguru" title="Follow on Twitter">
		<i class="fab fa-fw fa-twitter"></i>
	</a>
</li>

<button title="dark-mode-button" >
	<a class="dark-mode-button" >
		<i id="icon-dark" class="fa fa-moon"></i>
	  </a>
</button>
<script src="https://cdn.jsdelivr.net/npm/darkreader@4.9.44/darkreader.js"></script>
<script src="/assets/js/updation.js"></script>







            <!-- Search bar -->
            
		</ul>
	</nav>
</header>

    <div class="content">
      <article class="feature-image">
  <header style="background-image: url('/assets/img/Pycaret/banner.png')">
    <h1 class="title">PyCaret ğŸš€</h1>
    
    <p class="meta">
      April 11, 2023
      
    </p>
    
  </header>
  <section class="post-content"><h1 align="center">The Lazy Person's Guide to Machine Learning ğŸš€ </h1>

<p>ğŸ¤– Machine learning is a powerful tool for making predictions and extracting insights from data. However, building and evaluating machine learning models can be a time-consuming and tedious process, requiring expertise in programming, data preprocessing, and model selection. ğŸ˜© PyCaret is a Python library that aims to simplify and streamline the machine learning process by providing a high-level API for common machine learning tasks, such as data preprocessing, model training, and model interpretation. ğŸ¤—</p>

<p>In this blog post, we will demonstrate the key features of PyCaret on the telecom_custom_churn dataset, a classic binary classification problem in the telecom industry. ğŸ“Š</p>

<h3 id="setting-up-pycaret-ï¸">Setting up PyCaret ğŸ› ï¸</h3>

<p>The first step in using PyCaret is to install it using pip and import it into your Python environment. Once you have installed PyCaret, you can load the telecom_custom_churn(I chose this because i recently did some EDA on it <a href="https://github.com/AghoraGuru/AI-ML-Playground/blob/main/Customer_Prediction/Ds%2BCode/Prediction.ipynb">here</a>) dataset using the pycaret.datasets.get_data function and set up your PyCaret environment using the pycaret.classification.setup function. ğŸ The setup function performs automatic data preprocessing tasks such as missing value imputation, feature encoding, feature scaling, and feature selection, making it easy to prepare your data for machine learning. Hereâ€™s an example of how to set up your PyCaret environment:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pip <span class="nb">install </span>pycaret
</code></pre></div></div>

<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">pycaret.datasets</span> <span class="kn">import</span> <span class="n">get_data</span>
<span class="kn">from</span> <span class="nn">pycaret.classification</span> <span class="kn">import</span> <span class="n">setup</span><span class="p">,</span><span class="n">compare_models</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">get_data</span><span class="p">(</span><span class="s">'telecom_customer_churn'</span><span class="p">)</span>

<span class="n">clf</span> <span class="o">=</span> <span class="n">setup</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">target</span><span class="o">=</span><span class="s">'Customer Status'</span><span class="p">)</span>

<span class="n">best_model</span> <span class="o">=</span> <span class="n">compare_models</span><span class="p">()</span>
</code></pre></div></div>

<h3 id="comparing-models-">Comparing Models ğŸ¤”</h3>

<p>Once you have set up your PyCaret environment, you can train and evaluate several machine learning models using the pycaret.classification.compare_models function. This function gives you the parameters by which the model it thinks is best model. You can also use <code class="language-plaintext highlighter-rouge">tune_model()</code> to do 10 fold cv for 10 different combinations ğŸ˜ Hereâ€™s an example of how to compare several classification models using PyCaret:</p>

<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">best_model</span> <span class="o">=</span> <span class="n">pycaret</span><span class="p">.</span><span class="n">classification</span><span class="p">.</span><span class="n">compare_models</span><span class="p">()</span>
</code></pre></div></div>
<p style="text-align:center;">
<img src="/assets/img/Pycaret/tune_model.png" alt="compare_models" width="400" />
</p>
<p>The following performs various preprocessing steps such as splitting the dataset into training and testing sets, imputing missing values, encoding categorical variables, feature scaling, and more.</p>

<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">clf</span> <span class="o">=</span> <span class="n">setup</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">target</span><span class="o">=</span><span class="s">'Customer Status'</span><span class="p">)</span>
</code></pre></div></div>
<p style="text-align:center;">
<img src="/assets/img/Pycaret/compare_models.png" alt="compare_models" width="400" />
</p>
<h3 id="creating--interpreting-models-ï¸ï¸">Creating &amp; Interpreting Models ğŸ•µï¸â€â™€ï¸</h3>

<p>After selecting the best-performing model, you can use the pycaret.classification.interpret_model function to understand how the model is making predictions. This function generates several plots and charts that can help you understand the importance of different features in the model and how they are affecting the modelâ€™s predictions.The create_model function in PyCaret can create a wide range of machine learning models for different tasks. Hereâ€™s a list of some of the models you can create using create_model:</p>

<ul>
  <li>Linear Regression</li>
  <li>Logistic Regression</li>
  <li>Ridge Regression</li>
  <li>Lasso Regression</li>
  <li>Elastic Net</li>
  <li>Least Angle Regression</li>
  <li>K-Nearest Neighbors (KNN)</li>
  <li>Naive Bayes</li>
  <li>Decision Tree</li>
  <li>Random Forest</li>
  <li>Extra Trees</li>
  <li>Gradient Boosting</li>
  <li>Extreme Gradient Boosting (XGBoost)</li>
  <li>Light Gradient Boosting Machine (LightGBM)</li>
  <li>CatBoost</li>
</ul>

<p>Note that the available models may depend on the specific PyCaret version and any additional packages you have installed. You can also customize the hyperparameters of each model using the tune_model function in PyCaret to optimize their performance on your specific dataset. Hereâ€™s an example of how to interpret a random forest classifier using PyCaret:</p>

<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">rf_model</span> <span class="o">=</span> <span class="n">pycaret</span><span class="p">.</span><span class="n">classification</span><span class="p">.</span><span class="n">create_model</span><span class="p">(</span><span class="s">'rf'</span><span class="p">)</span>
<span class="n">pycaret</span><span class="p">.</span><span class="n">classification</span><span class="p">.</span><span class="n">interpret_model</span><span class="p">(</span><span class="n">rf_model</span><span class="p">)</span>
</code></pre></div></div>
<p style="text-align:center;">
  <figure style="display:inline-block; margin: 0 40px;">
    <img src="/assets/img/Pycaret/create_model.png" alt="Create Model" width="400" height="400" />
  </figure>
  
  <figure style="display:inline-block; margin: 0 40px;">
    <img src="/assets/img/Pycaret/interpret_model.png" alt="Interpret Model" width="400" height="400" />
  </figure>
</p>

<h3 id="saving-and-deploying-models-">Saving and Deploying Models ğŸ’¾</h3>

<p>Once you have trained and evaluated your machine learning model, you can save it using the pycaret.classification.save_model function and deploy it as a web service, API, or standalone application. PyCaret provides several deployment options, such as Flask, FastAPI, Streamlit, and REST API, making it easy to integrate your machine learning models into your applications.</p>

<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">save_model</span><span class="p">(</span><span class="n">best_model</span><span class="p">,</span><span class="s">'model'</span><span class="p">)</span>
</code></pre></div></div>

<h3 id="lets-see-how-to-load-the-model-and-predict-the-output">Letâ€™s see how to load the model and predict the output</h3>

<p>Loading the model</p>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="kn">import</span> <span class="nn">pickle</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">'model.pkl'</span><span class="p">,</span> <span class="s">'rb'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">pickle</span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</code></pre></div></div>
<p>Loading the data</p>

<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="n">drop</span><span class="p">(</span><span class="s">'Customer Status'</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s">'Customer Status'</span><span class="p">]</span>
</code></pre></div></div>

<p>Preprocessing the data</p>

<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">drop_first</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">drop_first</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">X_train</span><span class="p">,</span><span class="n">X_test</span><span class="p">,</span><span class="n">y_train</span><span class="p">,</span><span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">X_train</span> <span class="o">=</span> <span class="n">X_train</span><span class="p">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">X_test</span> <span class="o">=</span> <span class="n">X_test</span><span class="p">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

</code></pre></div></div>

<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">model</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span><span class="n">y_train</span><span class="p">)</span>
<span class="n">model</span><span class="p">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span><span class="n">y_test</span><span class="p">)</span>
</code></pre></div></div>
<p>And we got the score as 0.950319375443577 ! which is not the highest but yea it works !</p>

<h3 id="conclusion-">Conclusion ğŸ‰</h3>

<p>Now that you know the basics of PyCaret, you can start exploring its advanced features and use cases. With PyCaret, you can take your machine learning skills to the next level and tackle complex problems with confidence.</p>

<p>So what are you waiting for? Go ahead and try out PyCaret on your own datasets, and let us know how it goes!</p>

<p>Happy modeling! ğŸš€ğŸ‘¨â€ğŸ’»ğŸ”¬</p>

<h3 id="references-">References ğŸ“š</h3>

<ul>
  <li><a href="https://pycaret.org/">PyCaret Documentation</a></li>
</ul>
</section>
  
  

</article>

<!-- Disqus -->


<!-- Post navigation -->

  <div id="post-nav">
  
  <div id="previous-post" class="post-nav-post">
      <p>Previous post</p>
      <a href="/2023/03/07/HandCalcs.html">
        HandCalcs
      </a>
  </div>
  
  
</div>


    </div>
    
<script src="/assets/js/katex_init.js"></script>



<footer class="site-footer">
	<p class="text">Powered by nothing but Data.
</p>
</footer>


  </body>
</html>
